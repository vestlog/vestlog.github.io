<!-- start custom head snippets -->

<!-- Google Adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1695952648850095"
        crossorigin="anonymous"></script>

{%- comment -%}
If you already use jekyll-seo-tag (recommended), it will render <title>, description and canonical.
To avoid duplicates, only render our manual tags when the plugin is NOT present.
{%- endcomment -%}
{% unless site.plugins contains "jekyll-seo-tag" %}
  <title>{{ page.title | default: site.title }}</title>
  <meta name="description" content="{{ page.excerpt | default: site.description }}">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="{{ page.url | absolute_url }}">
{% endunless %}

<!-- RSS -->
<link rel="alternate" type="application/rss+xml" href="{{ site.url }}/my-feed.xml" title="{{ site.title }} Feed">

{%- comment -%} hreflang alternate links (KO <-> EN) {%- endcomment -%}
{% if page.alt_en or page.alt_ko %}
  {% assign ko_href = page.alt_ko | default: page.url | absolute_url %}
  {% assign en_href = page.alt_en | default: page.url | absolute_url %}
  <link rel="alternate" hreflang="ko" href="{{ ko_href }}">
  <link rel="alternate" hreflang="en" href="{{ en_href }}">
  <link rel="alternate" hreflang="x-default" href="{{ ko_href }}">
{% endif %}

<!-- Language toggle styles (ALWAYS in head, never inside posts) -->
<style>
  /* 기본: 한국어 패널 표시, 영어 패널 숨김 */
  .lang-panel { display: none; }
  .lang-panel.lang-ko { display: block; }

  /* EN 모드에서만 영어 패널 표시 */
  body[data-lang="en"] .lang-panel.lang-ko { display: none; }
  body[data-lang="en"] .lang-panel.lang-en { display: block; }

  /* 문단 안 한 줄 번역(인라인) */
  .lang-en-inline { display: none; }
  body[data-lang="en"] .lang-en-inline { display: inline; }
</style>

<!-- Tiny JS: remember language and expose toggleLang() for the button -->
<script>
(function () {
  // 페이지가 가진 기본 언어(프런트매터: page.lang). 없으면 ko.
  var pageDefault = '{{ page.lang | default: "ko" }}';
  var saved = null;
  try { saved = localStorage.getItem('siteLang'); } catch (e) {}

  var lang = (saved === 'en' || saved === 'ko') ? saved : pageDefault;

  // HTML lang 동기화
  document.documentElement.setAttribute('lang', lang === 'en' ? 'en' : 'ko');

  // body가 아직 없을 수 있으므로 DOM 준비 후에도 한 번 더 적용
  function apply(langVal){
    var b = document.body;
    if (b) b.setAttribute('data-lang', langVal);
    document.documentElement.setAttribute('lang', langVal === 'en' ? 'en' : 'ko');
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function(){ apply(lang); });
  } else {
    apply(lang);
  }

  // 전역 토글 함수: 푸터/헤더 버튼에서 onclick="toggleLang()"
  window.toggleLang = function () {
    var b = document.body || document.documentElement;
    var next = (b.getAttribute('data-lang') === 'en') ? 'ko' : 'en';
    apply(next);
    try { localStorage.setItem('siteLang', next); } catch (e) {}
  };
})();
</script>

<!-- end custom head snippets -->
